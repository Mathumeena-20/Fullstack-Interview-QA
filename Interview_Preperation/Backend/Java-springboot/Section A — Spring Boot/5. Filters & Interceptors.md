# üîµ **SECTION 1 ‚Äî FILTERS**

---

# ‚≠ê 1. What is a Servlet Filter?

A **Servlet Filter** is a component that intercepts **HTTP requests and responses** **before they reach the servlet/controller**.

‚úî Part of Java Servlet Specification
‚úî Works at **web layer (before Spring)**
‚úî Can modify request, response, headers

Common uses:

* Logging requests
* Authentication
* Compression & caching
* CORS
* XSS, security filters

**Filter lifecycle controlled by Servlet Container (Tomcat).**

---

# ‚≠ê 2. How do you create a custom filter in Spring Boot?

### Example: Logging Filter

```java
@Component
public class LoggingFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        System.out.println("Incoming request: " + req.getRequestURI());

        chain.doFilter(request, response);  // pass to next filter/controller
    }
}
```

Spring Boot automatically registers `@Component` filters.

To set order:

```java
@Bean
public FilterRegistrationBean<LoggingFilter> loggingFilter() {
    FilterRegistrationBean<LoggingFilter> bean = new FilterRegistrationBean<>();
    bean.setFilter(new LoggingFilter());
    bean.setOrder(1);
    return bean;
}
```

---

# ‚≠ê 3. Difference between Filter and Interceptor

| Feature                          | **Filter**              | **Interceptor**                |
| -------------------------------- | ----------------------- | ------------------------------ |
| Level                            | Servlet level (Tomcat)  | Spring MVC level               |
| API                              | javax.servlet.Filter    | HandlerInterceptor             |
| Executes                         | Before controller       | Before & after Handler         |
| Access to handler method?        | ‚ùå No                    | ‚úî Yes                          |
| Best for                         | Logging, security, CORS | Authentication, business logic |
| Able to read method annotations? | ‚ùå No                    | ‚úî Yes                          |

**Filters ‚Üí Lower level**
**Interceptors ‚Üí Spring MVC aware**

---

# ‚≠ê 4. Use cases of filters in real projects

‚úî CORS filter
‚úî Authentication token extraction
‚úî Request/response logging
‚úî GZIP compression
‚úî XSS sanitization
‚úî Rate limiting
‚úî IP blocking
‚úî Multi-tenant header extraction

Real example:
*We used a filter to extract `X-Tenant-ID` header and set it into MDC for logging.*

---

# ‚≠ê 5. When does a filter get executed?

Filter order:

```
Client ‚Üí Filter 1 ‚Üí Filter 2 ‚Üí DispatcherServlet ‚Üí Controller
```

‚úî Executes **before DispatcherServlet**
‚úî Executes **after response** when returning

---

---

# üîµ **SECTION 2 ‚Äî INTERCEPTORS**

---

# ‚≠ê 6. What is a Spring Interceptor?

A **Spring MVC Interceptor** intercepts requests **after entering Spring**, but **before reaching controller methods**.

‚úî Part of Spring MVC framework
‚úî Works with handler methods
‚úî Can read annotations, path variables, method signatures

---

# ‚≠ê 7. How do you implement HandlerInterceptor?

### Example: Authentication Interceptor

```java
@Component
public class AuthInterceptor implements HandlerInterceptor {

    @Override
    public boolean preHandle(HttpServletRequest request,
                             HttpServletResponse response,
                             Object handler) throws Exception {

        String token = request.getHeader("Authorization");

        if (token == null) {
            response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
            return false; // stop request
        }
        return true; // allow request
    }
}
```

---

# ‚≠ê 8. Difference between preHandle(), postHandle(), afterCompletion()

| Method                | When Called                                          | Use Case                     |
| --------------------- | ---------------------------------------------------- | ---------------------------- |
| **preHandle()**       | Before controller executes                           | Authentication, validation   |
| **postHandle()**      | After controller returns but **before** view renders | Modify model, add attributes |
| **afterCompletion()** | After response is fully sent                         | Logging, freeing resources   |

Example flow:

```
preHandle() ‚Üí Controller ‚Üí postHandle() ‚Üí View ‚Üí afterCompletion()
```

---

# ‚≠ê 9. Real-time scenario where you used interceptor

Examples from real projects:

### ‚úî API Key Validation

* Validate API Key for all internal API requests

### ‚úî Role-based Access Control

* Read user roles via JWT
* Compare with method-level annotations

### ‚úî Request Logging (User ID, Request ID)

* Inject MDC values for traceability

### ‚úî Rate limiting

* Check if user exceeded allowed API requests

### ‚úî Multi-tenancy

* Extract tenant from header
* Set thread-local context

---

# ‚≠ê 10. How do you register multiple interceptors?

Create configuration:

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Autowired
    private AuthInterceptor authInterceptor;

    @Autowired
    private LoggingInterceptor loggingInterceptor;

    @Override
    public void addInterceptors(InterceptorRegistry registry) {

        registry.addInterceptor(loggingInterceptor)
                .addPathPatterns("/**")
                .order(1);

        registry.addInterceptor(authInterceptor)
                .addPathPatterns("/api/**")
                .order(2);
    }
}
```

‚úî Supports ordering
‚úî Supports path pattern matching

---

# üîµ **FILTER VS INTERCEPTOR SUMMARY TABLE**

| Feature                     | Filter                      | Interceptor                   |
| --------------------------- | --------------------------- | ----------------------------- |
| Level                       | Servlet                     | Spring MVC                    |
| Runs Before                 | DispatcherServlet           | Controller                    |
| Can modify Response?        | ‚úî Yes                       | ‚úî Yes                         |
| Read input JSON             | Hard                        | Easy                          |
| Access handler/method       | ‚ùå No                        | ‚úî Yes                         |
| Return boolean to stop flow | ‚ùå No (must throw exception) | ‚úî Yes                         |
| Best for                    | Cross-cutting concerns      | Business + request processing |

---

# ‚≠ê FINAL INTERVIEW SUMMARY

### **Filters**

‚úî Pre-Servlet
‚úî Good for security, logging, CORS
‚úî Implement `Filter`
‚úî Registered via FilterRegistrationBean
‚úî Executes before Spring MVC

### **Interceptors**

‚úî Spring MVC layer
‚úî Implement `HandlerInterceptor`
‚úî Methods: preHandle, postHandle, afterCompletion
‚úî Register using `WebMvcConfigurer`
‚úî Good for auth, audit logs, permission check

---

