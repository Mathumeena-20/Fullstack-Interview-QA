# üîµ **1. What is Spring Scheduler?**

Spring Scheduler is a **built-in scheduling framework** in Spring that allows methods to run **automatically at fixed intervals, delays, or cron expressions**.

Examples of scheduled tasks:
‚úî Sending emails
‚úî Cleaning temporary files
‚úî Auto-backups
‚úî Syncing data from third-party APIs
‚úî Generating reports

Spring uses the `TaskScheduler` and runs jobs in background threads.

---

# üîµ **2. What is @EnableScheduling?**

`@EnableScheduling` enables Spring scheduling support in the application.

Example:

```java
@SpringBootApplication
@EnableScheduling
public class MyApp { }
```

Without this annotation, `@Scheduled` will not work.

---

# üîµ **3. What is @Scheduled?**

`@Scheduled` is used to mark a method as a scheduled task.

Example:

```java
@Scheduled(fixedRate = 5000)
public void autoBackup() {
    System.out.println("Running every 5 seconds");
}
```

It supports:

* fixedRate
* fixedDelay
* cron expression

---

# üîµ **4. Difference between fixedRate and fixedDelay**

| Attribute      | Meaning                                         | Example                  |
| -------------- | ----------------------------------------------- | ------------------------ |
| **fixedRate**  | Time between **method starts**                  | Run every X milliseconds |
| **fixedDelay** | Time between **method finishes** and next start | Wait after completion    |
| **cron**       | Run at specific time patterns                   | Every day at 5 PM        |

### Example:

```java
// Executes every 5s regardless of method execution time
@Scheduled(fixedRate = 5000)

// Executes 5s AFTER method completes
@Scheduled(fixedDelay = 5000)
```

---

# üîµ **5. What is a cron expression?**

A cron expression defines **complex time-based schedules**.

Format:

```
second minute hour day month day-of-week
```

Examples:

| Cron                   | Meaning               |
| ---------------------- | --------------------- |
| `"0 * * * * *"`        | Every minute          |
| `"0 0 0 * * *"`        | Every day at midnight |
| `"0 0/5 * * * *"`      | Every 5 minutes       |
| `"0 30 9 * * MON-FRI"` | 9:30 AM on weekdays   |

Example:

```java
@Scheduled(cron = "0 0 9 * * MON-FRI")
public void startDailyJob() { }
```

---

# üîµ **6. Can we run scheduled jobs in a cluster environment?**

**Yes, but with precautions.**

Problem:

* If you have 3 instances of your Spring Boot app running,
* all 3 will run the same jobs at the same time ‚Üí **duplicate execution**

Solutions:
‚úî Use distributed locks
‚úî Quartz Scheduler with clustering
‚úî Database locking (PostgreSQL advisory locks)
‚úî Redis lock (Redisson)
‚úî Use leader election (Kubernetes)

Example Redis lock:

```java
RLock lock = redissonClient.getLock("jobLock");
if (lock.tryLock()) {
    // run job
    lock.unlock();
}
```

---

# üîµ **7. How do you avoid overlapping jobs?**

If a job takes long, it may overlap the next run.

Spring solution:

```java
@Scheduled(fixedRate = 5000)
@SchedulerLock(name = "reportJob")
public void generateReport() { }
```

But by default Spring **does not prevent overlap**.

Best practices:
‚úî Use Quartz
‚úî Use ShedLock (popular library)
‚úî Use Redisson lock
‚úî Use DB locks

Example with ShedLock:

```java
@Scheduled(cron = "0 0 * * * *")
@SchedulerLock(name = "hourlyJob", lockAtMostFor = "55m")
public void hourlyJob() { }
```

---

# üîµ **8. How do you stop scheduled jobs?**

Ways to stop:

### ‚úî Stop entire scheduler

```java
@Configuration
@EnableScheduling
public class SchedulerConfig implements SchedulingConfigurer {

    @Override
    public void configureTasks(ScheduledTaskRegistrar registrar) {
        registrar.setScheduler(Executors.newScheduledThreadPool(0));
    }
}
```

### ‚úî Use conditional scheduling

```java
@Scheduled(cron = "${app.jobs.run ? '0 * * * * *' : '-'}")
```

### ‚úî Use a flag

```java
if (!enabled) return;
```

### ‚úî Stop application instance

---

# üîµ **9. What happens if a scheduled method throws exception?**

If exception is **unchecked**:
‚úî the current execution stops
‚úî next scheduled execution WILL RUN normally
‚úî task is **not killed permanently**

Example:

```java
@Scheduled(fixedRate = 5000)
public void runJob() {
    throw new RuntimeException("Error!");
}
```

Spring catches exceptions internally ‚Üí next cycle still triggers.

To prevent failure:

```java
try {
    // job logic
} catch (Exception e) {
    log.error("Error", e);
}
```

---

# üîµ **10. Real-world example of scheduling tasks**

### Example: Daily report generator

```java
@Service
public class ReportService {

    @Scheduled(cron = "0 0 1 * * *") // every day at 1 AM
    public void generateDailyReport() {
        System.out.println("Generating daily report...");
        // fetch data, generate CSV, email it
    }
}
```

### Example: Auto-clean temp files

```java
@Scheduled(fixedDelay = 60000)
public void cleanTemporaryFiles() {
    fileService.deleteOldFiles();
}
```

### Example: Sync data from external API periodically

```java
@Scheduled(fixedRate = 300000) // every 5 minutes
public void syncData() {
    apiClient.fetchData();
}
```

---

# ‚≠ê FINAL INTERVIEW SUMMARY

| Topic                   | Key Point                               |
| ----------------------- | --------------------------------------- |
| Spring Scheduler        | Runs methods automatically at intervals |
| @EnableScheduling       | Activates scheduling                    |
| @Scheduled              | Marks methods as scheduled tasks        |
| fixedRate vs fixedDelay | Start time vs end time difference       |
| Cron                    | Complex scheduling expression           |
| Cluster environment     | Need distributed locks / ShedLock       |
| Avoid overlapping       | Use locks, or Quartz                    |
| Stop jobs               | Disable scheduler or use flags          |
| Exception thrown        | Only current run fails                  |
| Real use cases          | Email jobs, cleanup, sync, reporting    |

---

